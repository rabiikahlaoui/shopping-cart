import{b as re}from"./chunk-NRH7TOA7.js";import{a as ie}from"./chunk-RNS5JHH5.js";import{$a as J,Ab as ae,Bb as ce,C as B,Ca as z,Da as C,Ea as b,Fa as w,G as D,Ga as y,Ha as v,Ia as U,Ja as S,K as u,Ka as T,La as I,Ma as r,Na as i,Oa as h,P as _,Pa as k,Q as P,Qa as f,Ra as H,Sa as x,T as V,Ta as s,Ya as G,Za as Y,_ as g,_a as c,ab as M,bb as K,ca as $,cb as W,db as X,e as L,eb as R,fb as Z,gb as ee,ib as l,kb as te,lb as E,ma as a,vb as ne,wa as p,wb as oe}from"./chunk-PQWZK6KR.js";function de(t){t||(t=u(V));let n=new L(e=>{if(t.destroyed){e.next();return}return t.onDestroy(e.next.bind(e))});return e=>e.pipe(B(n))}var N=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=p({type:t,selectors:[["app-spinner"]],decls:4,vars:0,consts:[["role","status","aria-live","polite","aria-busy","true",1,"spinner-wrapper","flex","justify-center"],["aria-hidden","true",1,"spinner"],[1,"sr-only"]],template:function(e,o){e&1&&(r(0,"div",0),h(1,"div",1),r(2,"span",2),c(3,"Chargement"),i()())},styles:[".spinner-wrapper[_ngcontent-%COMP%]{margin:2rem 0}.spinner[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;border:3px solid #f7f8fa;border-top-color:#007461;border-radius:50%;animation:_ngcontent-%COMP%_spinner-rotate .8s linear infinite}@keyframes _ngcontent-%COMP%_spinner-rotate{to{transform:rotate(360deg)}}"]})};var se={apiBaseUrl:"https://api.example.com"};var j=class t{baseUrl=se.apiBaseUrl;get apiUrl(){return`${this.baseUrl}${this.apiPath}`}static \u0275fac=function(e){return new(e||t)};static \u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"})};var q=class t extends j{apiPath="/api/products";http=u(re);getProducts(){return this.http.get(this.apiUrl)}static \u0275fac=(()=>{let n;return function(o){return(n||(n=$(t)))(o||t)}})();static \u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"})};function pe(t,n){if(t&1&&c(0),t&2){s();let e=X(6);M(" ",e," ")}}function le(t,n){t&1&&(r(0,"span",6),c(1,"Sans nom"),i())}function me(t,n){if(t&1&&(r(0,"option",14),c(1),i()),t&2){let e=n.$implicit;f("value",e),a(),M(" ",e," ")}}function ge(t,n){if(t&1){let e=k();r(0,"div",11)(1,"label",12),c(2,"Quantit\xE9:"),i(),r(3,"select",13),x("change",function(d){_(e);let m=s(2);return P(m.setQuantity(d))}),y(4,me,2,2,"option",14,w),i(),r(6,"button",15),x("click",function(){_(e);let d=s(2);return P(d.addToCart())}),h(7,"i",16),c(8," Ajouter "),i()()}if(t&2){let e=s(2);a(),f("htmlFor","quantity-"+e.product().id),a(2),f("id","quantity-"+e.product().id)("value",e.effectiveQuantityToAdd()),a(),v(e.quantityOptions),a(2),z("aria-label","Ajouter "+(e.product().productName||"cet article")+" au panier")}}function fe(t,n){t&1&&(r(0,"p",10),c(1,"Tout est dans le panier"),i())}function Ce(t,n){if(t&1&&C(0,ge,9,4,"div",11)(1,fe,2,0,"p",10),t&2){let e=s();b(e.availableQuantity()>0?0:1)}}function be(t,n){t&1&&(r(0,"p",10),c(1,"Non disponible"),i())}var ye={Food:"bi bi-basket",Medecine:"bi bi-capsule",Books:"bi bi-book",Electric:"bi bi-plug",Parfum:"bi bi-droplet"},ve="bi bi-cart",F=class t{product=E.required();cartStore=u(ce);quantityToAdd=g(1);categoryIconClass=l(()=>{let n=this.product()?.category;return n&&ye[n]||ve});priceTtc=l(()=>ae(this.product()));availableQuantity=l(()=>{let n=this.cartStore.getQuantityInCart(this.product().id);return this.product().quantity-n});effectiveQuantityToAdd=l(()=>Math.min(this.quantityToAdd(),this.availableQuantity()));get quantityOptions(){let n=this.availableQuantity();return Array.from({length:n},(e,o)=>o+1)}setQuantity(n){let e=n.target.value;this.quantityToAdd.set(Number(e))}addToCart(){let n=this.product(),e=this.effectiveQuantityToAdd();this.cartStore.addItem(n,e)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=p({type:t,selectors:[["app-product-card"]],inputs:{product:[1,"product"]},decls:18,vars:16,consts:[[1,"product-item","flex","flex-col"],[1,"product-details","flex","align-start"],[1,"product-category-icon"],["aria-hidden","true"],[1,"product-info-container","flex-fill"],[1,"product-name"],[1,"product-name-placeholder"],[1,"product-info","flex","align-center"],[1,"product-category"],[1,"product-price","ml-auto"],[1,"product-stock-message"],[1,"add-to-cart","flex","align-center"],[3,"for"],["aria-label","Quantit\xE9 \xE0 ajouter",3,"change","id","value"],[3,"value"],["type","button",1,"btn","btn-primary",3,"click"],[1,"bi","bi-bag-plus"]],template:function(e,o){if(e&1&&(r(0,"article",0)(1,"div",1)(2,"div",2),h(3,"i",3),i(),r(4,"div",4)(5,"h2",5),K(6),C(7,pe,1,1)(8,le,2,0,"span",6),i(),r(9,"div",7)(10,"p",8),c(11),R(12,"titlecase"),i(),r(13,"p",9),c(14),R(15,"currency"),i()()()(),C(16,Ce,2,1)(17,be,2,0,"p",10),i()),e&2){G("out-of-stock",o.product().quantity<=0),a(3),Y(o.categoryIconClass()),a(3);let d=W(o.product().productName.trim());a(),b(d?7:8),a(4),M(" ",Z(12,9,o.product().category)," "),a(3),M(" ",ee(15,11,o.priceTtc(),"EUR","symbol","1.2-2")," "),a(2),b(o.product().quantity>0?16:17)}},dependencies:[oe,ne],styles:[".product-item[_ngcontent-%COMP%]{overflow:hidden;border:1px solid #c1c9d6;border-radius:.5rem;transition:box-shadow .15s ease-in-out;box-shadow:0 2px 4px #1018281a;height:100%}.product-item[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #1315174d}.product-item.out-of-stock[_ngcontent-%COMP%]{opacity:.6}.product-item[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]{padding:1rem;gap:1.5rem}.product-item[_ngcontent-%COMP%]   .product-details[_ngcontent-%COMP%]   .product-category-icon[_ngcontent-%COMP%]{padding:.5rem;border-radius:.5rem;background-color:#f7f8fa;font-size:1.5rem}.product-item[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;margin-bottom:auto}.product-item[_ngcontent-%COMP%]   .product-name-placeholder[_ngcontent-%COMP%]{color:#9ca3af;font-style:italic;font-weight:500}.product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]{margin-top:.5rem;margin-bottom:1rem}.product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-category[_ngcontent-%COMP%]{color:#9ca3af;font-size:.875rem;font-weight:500}.product-item[_ngcontent-%COMP%]   .product-info[_ngcontent-%COMP%]   .product-price[_ngcontent-%COMP%]{color:#007461;font-size:1.25rem;font-weight:600}.product-item[_ngcontent-%COMP%]   .add-to-cart[_ngcontent-%COMP%]{padding:1rem;gap:.5rem;flex-wrap:wrap;background-color:#f7f8fa}.product-item[_ngcontent-%COMP%]   .add-to-cart[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500}.product-item[_ngcontent-%COMP%]   .add-to-cart[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.25rem .5rem;border-radius:.25rem;border:1px solid #c1c9d6}.product-item[_ngcontent-%COMP%]   .add-to-cart[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{white-space:nowrap;margin-left:auto}.product-item[_ngcontent-%COMP%]   .product-stock-message[_ngcontent-%COMP%]{color:#9ca3af;font-size:.875rem;margin-top:.5rem;padding:1rem}"]})};function _e(t,n){if(t&1&&(r(0,"option",4),c(1),i()),t&2){let e=n.$implicit;f("value",e),a(),J(e)}}var A=class t{categories=E.required();selectedCategory=E.required();categoryChange=te();setCategory(n){let e=n.target.value;this.categoryChange.emit(e)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=p({type:t,selectors:[["app-products-filter"]],inputs:{categories:[1,"categories"],selectedCategory:[1,"selectedCategory"]},outputs:{categoryChange:"categoryChange"},decls:8,vars:1,consts:[[1,"products-filter","flex","align-center","justify-end"],["for","category-filter"],["id","category-filter",3,"change","value"],["value",""],[3,"value"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"label",1),c(2,"Cat\xE9gorie"),i(),r(3,"select",2),x("change",function(m){return o.setCategory(m)}),r(4,"option",3),c(5,"Toutes"),i(),y(6,_e,2,2,"option",4,w),i()()),e&2&&(a(3),f("value",o.selectedCategory()),a(3),v(o.categories()))},styles:[".products-filter[_ngcontent-%COMP%]{margin:2rem 0 1rem;gap:1rem}.products-filter[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:.5rem;border:1px solid #c1c9d6;font-size:1rem;min-width:10rem}"]})};var Pe=(t,n)=>n.id;function he(t,n){t&1&&I(0,"app-spinner")}function xe(t,n){if(t&1&&I(0,"app-product-card",4),t&2){let e=n.$implicit;U("product",e)}}function Me(t,n){if(t&1){let e=k();S(0,"app-products-filter",2),H("categoryChange",function(d){_(e);let m=s();return P(m.setCategory(d))}),T(),S(1,"div",3),y(2,xe,1,1,"app-product-card",4,Pe),T()}if(t&2){let e=s();U("categories",e.categories())("selectedCategory",e.selectedCategory()),a(2),v(e.filteredProducts())}}var ue=class t{productsService=u(q);products=g([]);loading=g(!0);selectedCategory=g("");categories=l(()=>{let n=this.products();return[...new Set(n.map(o=>o.category))].sort()});filteredProducts=l(()=>{let n=this.products(),e=this.selectedCategory();return[...e?n.filter(d=>d.category===e):n].sort((d,m)=>(d.quantity>0?0:1)-(m.quantity>0?0:1))});constructor(){this.productsService.getProducts().pipe(de()).subscribe(n=>{this.products.set(n),this.loading.set(!1)})}setCategory(n){this.selectedCategory.set(n)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=p({type:t,selectors:[["app-products-page"]],decls:4,vars:1,consts:[["title","Produits"],["role","main","tabindex","-1",1,"container"],[3,"categoryChange","categories","selectedCategory"],[1,"products-list"],[3,"product"]],template:function(e,o){e&1&&(I(0,"app-subheader",0),S(1,"main",1),C(2,he,1,0,"app-spinner")(3,Me,4,2),T()),e&2&&(a(2),b(o.loading()?2:3))},dependencies:[ie,N,F,A],styles:[".products-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:12rem}.products-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem}@media(max-width:1024px){.products-list[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media(max-width:520px){.products-list[_ngcontent-%COMP%]{grid-template-columns:repeat(1,1fr)}}"]})};export{ue as ProductsPage};
