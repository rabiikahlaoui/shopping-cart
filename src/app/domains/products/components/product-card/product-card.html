<article class="product-item flex flex-col" [class.out-of-stock]="product().quantity <= 0">
  <h2>
    @let name = product().productName.trim();
    @if (name) {
        {{ name }}
    } @else {
        <span class="product-name-placeholder">Sans nom</span>
    }
  </h2>

  <div class="product-info flex align-center">
    <p class="product-category">
      {{ product().category | titlecase }}
    </p>

    <p class="product-price ml-auto">
      {{ product() | priceTtc | currency:'EUR':'symbol':'1.2-2' }}
    </p>
  </div>

  @if (product().quantity > 0) {
    @if (availableQuantity() > 0) {
    <div class="add-to-cart flex align-center">
        <label [for]="'quantity-' + product().id">Quantit√©</label>
        <select [id]="'quantity-' + product().id" [value]="effectiveQuantityToAdd()" (change)="setQuantity($event)">
        @for (quantity of quantityOptions; track quantity) {
        <option [value]="quantity">
            {{ quantity }}
        </option>
        }
        </select>
        <button
          type="button"
          class="btn btn-primary"
          [attr.aria-label]="'Ajouter ' + (product().productName || 'cet article') + ' au panier'"
          (click)="addToCart()"
        >
          Ajouter au panier
        </button>
    </div>
    } @else {
        <p class="all-in-cart">Tout est dans le panier</p>
    }
  } @else {
    <p>Non disponible</p>
  }
</article>